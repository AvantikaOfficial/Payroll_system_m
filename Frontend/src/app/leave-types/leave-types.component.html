<app-nav-bar></app-nav-bar>
<div class="page-wrapper">

    <!-- Start Content -->
    <div class="content">

        <!-- Page Header -->
        <div class="d-flex align-items-center justify-content-between flex-wrap row-gap-3 mb-3">
            <div class="flex-grow-1">
                <h5 class="fw-bold">Leaves</h5>
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb breadcrumb-divide p-0 mb-0">
                        <li class="breadcrumb-item d-flex align-items-center"><a href="dashboard"><i
                                    class="ti ti-home me-1"></i>Home</a></li>
                        <li class="breadcrumb-item active" aria-current="page">Leaves</li>
                    </ol>
                </nav>
            </div>
            <div>
                <a href="javascript:void(0);" class="btn btn-primary" data-bs-toggle="modal"
                    data-bs-target="#add_modal"><i class="ti ti-circle-plus me-1"></i>New Leave Type</a>
            </div>
        </div>
        <!-- End Page Header -->

        <div class="d-flex align-items-center mb-3">
            <a href="leaves" class="btn btn-sm btn-light border fs-14 me-2">All Leaves</a>
            <a href="leave-types" class="btn btn-sm btn-dark fs-14">Leave Types</a>
        </div>

        <div class="table-responsive">
            <table class="table table-nowrap border">
                <thead class="thead-light">
                    <tr>
                        <th>Leave Type</th>
                        <th>Created On</th>
                        <th>Status</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let leave of leaveTypes">
                        <td>{{ leave.name }}</td>
                        <td>{{ leave.created_at | date }}</td>
                        <td>{{ leave.status || 'Active' }}</td>
                        <td class="d-flex gap-2">
                            <button class="btn btn-sm btn-primary" (click)="openEditModal(leave, editModal)">
                                Edit
                            </button>
                            <button class="btn btn-sm btn-danger"
                                (click)="openDeleteModal(leave.id!, deleteModal)">
                                Delete
                            </button>
                        </td>
                    </tr>
                    <tr *ngIf="leaveTypes.length === 0">
                        <td colspan="4" class="text-center text-muted">No leave types found</td>
                    </tr>
                </tbody>
            </table>
        </div>

    </div>
</div>

<!-- Add Leave Modal -->
<div class="modal fade" id="add_modal" #addModal tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h6 class="fw-bold mb-0">Add New Leave Type</h6>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <form [formGroup]="addForm" (ngSubmit)="addLeave(addModal)">
                <div class="modal-body">
                    <label class="form-label">Leave Type <span class="text-danger">*</span></label>
                    <input type="text" class="form-control" formControlName="name">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add Leave Type</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Edit Leave Modal -->
<div class="modal fade" id="edit_modal" #editModal tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h6 class="fw-bold mb-0">Edit Leave</h6>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <form [formGroup]="editForm" (ngSubmit)="saveEdit(editModal)">
                <div class="modal-body">
                    <label class="form-label">Leave Type <span class="text-danger">*</span></label>
                    <input type="text" class="form-control" formControlName="name">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Changes</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Delete Modal -->
<div class="modal fade" #deleteModal tabindex="-1">
  <div class="modal-dialog modal-dialog-centered modal-sm">
    <div class="modal-content">
      <div class="modal-body text-center">
        <h6 class="mb-1">Delete Confirmation</h6>
        <p class="mb-3">Are you sure want to delete this leave type?</p>
        <div class="d-flex justify-content-center gap-2">
          <button type="button" class="btn btn-light w-50" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-danger w-50" (click)="confirmDelete(deleteModal)">Yes, Delete</button>
        </div>
      </div>
    </div>
  </div>
</div>
